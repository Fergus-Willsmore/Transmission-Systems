\documentclass{article}

% This Document is designed to house the writing for the 
% concepts learnt for my MPhil.
% Created by F.R. Willsmore

% Packages
\usepackage[utf8]{inputenc}
\usepackage[top=1in, bottom=1.25in, left=1.25in, right=1.25in]{geometry}
\usepackage{graphicx} 
\usepackage{fancyhdr}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{lipsum}
\usepackage{bm}
\usepackage{array}
\usepackage{multirow}
\usepackage{caption}
\usepackage[dvipsnames]{xcolor}
\usepackage{parskip}
\usepackage[toc,page]{appendix}
\usepackage[hidelinks]{hyperref}
\usepackage{float}

% Commands
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\newcommand{\ie}{\textit{i.e. }}
\newcommand{\eg}{\textit{e.g. }}
\newcommand{\iid}{i.i.d. }
\newcommand{\e}{\varepsilon}
\renewcommand{\l}{\ell}
\newcommand{\mc}{\mathcal}
\renewcommand{\t}{\text}
\setlength\parindent{24pt}


% struts for table environments
\newcommand\Tstrut{\rule{0pt}{2.6ex}}         % = `top' strut
\newcommand\Bstrut{\rule[-0.9ex]{0pt}{0pt}}   % = `bottom' strut
\newcommand{\exedout}{%
  \rule{0.8\textwidth}{0.5\textwidth}%
}

\hypersetup{
    colorlinks,
%    linkcolor={red!50!black},
%    citecolor={blue!50!black},
%    urlcolor={blue!80!black}
    linkcolor={blue},
    citecolor={red},
    urlcolor={blue}
}
\renewcommand*{\sectionautorefname}{Section} % capitalises Section in \autoref

% Headers
\pagestyle{fancy}
\lhead{MPhil}
\chead{}
\rhead{Modelling Cascade Failure}
\lfoot{}
\cfoot{\thepage}
\rfoot{}

% Title
\title{Concepts Learnt for MPhil}
\author{Fergus Willsmore}
\date{\today}

\begin{document}
\maketitle

\newpage

\tableofcontents

\newpage

\section{Glossary}

\begin{itemize}
\item[] {\it interconnection system} conveys power from generators to demand locations (loads). 
\item[] {\it transmission system} carries power at high voltages, typically over long distances. 
\item[] {\it distribution system} distributes power within a local geographical area at low voltage. 
\item[] {\it buses} represent the nodes of the network and may house generators and others represent where a distribution system (a load) is attached.
\item[] {\it lines} represent the power lines used to transmit power between buses.
\item[] {\it transformers} are used to convert between different voltages.
\item[] {\it real} power $P$ is the power actually supplied to the load.
\item[] {\it reactive} power $Q$ is the power that bounces back and fourth between the load and generator (energy lost due to electric and magnetic fields).
\item[] {\it complex} power $S$ is the effective power produced by alternating current, $S=P+iQ$.
\item[] {\it resistance} $r$ is the force against the flow of current offered by the material of the conductor.
\item[] {\it reactance} $x$ is the resistance offered by inductors and capacitors with respect to time.
\item[] {\it impedance} $z$ is the effective resistance to alternating current, $z=r+ix$. 
\item[] {\it conductance} $g$
\item[] {\it susceptance} $b$
\item[] {\it admittance} $y=g+ib$

\end{itemize}

\section{Electric Current}

Electrical flow can be thought of as the movement of electrons through a surface, referred to as the {\it current} ($I$). The movement of charge is provoked by the {\it voltage} ($V$) of an electrical circuit. The voltage creates a potential electrical difference such that the negatively charged electrons flow within the circuit. This is best thought of as electrical potential energy, such that as voltage is increased more force is required to hold the electrons in a fixed position. Once released the electron will accelerate toward the positive pole resulting in the conversion of electrical potential energy into heat and kinetic energy. The idea of {\it electric power}, combines the elements {\it current} and {\it voltage} such that 
\begin{equation}
P=V\times I
\end{equation}
expressed in watts. There are two distinct types of power flows, namely {\it direct current} (DC) and {\it alternating current} (AC). The simpler of the two is DC power, where the electrons always flow in the same direction (such as battery operated circuits). In a battery operated circuit the electrons always move from the negative pole to the positive pole. However in an AC circuit, the direction of current periodically changes, which gives rise to complex behaviour.  

\section{AC vs DC}

Electrical {\it current} is the flow of electrons through a surface measured as a rate. There are two different types; alternating current and direct current. The main distinction between the two is that the flow of electrons for DC is linear, \ie, the electrons (- charge) will move directly to the positive charge, whereas in AC the direction of flow alternates direction periodically with fixed frequency. The benefits of DC is that it is more efficient at electrical transmission over short distances due to the linear flow and limited power loss. However, the benefit of AC is that the voltage can be easily changed by a transformer thus allowing high voltage transmission for larger distances. Therefore the majority power is sourced from AC generators. 

\section{DC power flows}

The AC power flows along line ${k,m}$ are described by the complex quantity $p_{km}+iq_{km}$ such that
\begin{eqnarray}
p_{km} &=& |V_k|^2g_{km}-|V_k||V_m|g_{km}\cos \theta_{km}-|V_k||V_m|b_{km}\sin \theta_{km}\\
q_{km} &=& -|V_k|^2\big(b_{km}+\frac{1}{2}b_{km}^{sh} \big)+|V_k||V_m|b_{km}\cos \theta_{km}-|V_k||V_m|g_{km}\sin \theta_{km}.
\end{eqnarray}
These are complex equations that lead to quadratic power flows which can lead solutions that do not converge. Hence it is typical to approximate these AC flows with DC flows that lead to a system of linear equations which can easily be solved. 
\begin{itemize}
\item Under normal conditions $|V_k|\approx 1$ for each bus $k$
\item Under normal conditions $|\theta_{km}|$ is small for each line $(k,m)$
\item For any line $(k,m)$, its resistance is much smaller than its reactance \ie $r_{km}<<x_{km}$.
\end{itemize}
Using these approximations in the (active) power flow, we obtain
\begin{equation}
p_{km}=\frac{\theta_k-\theta_m}{x_{km}}.
\end{equation}
It is convenient to write the system in matrix form
\begin{equation}
P=\mathcal{B}\theta,
\end{equation}
where $P$ is the vector of power injections and  $\mathcal{B}$ is called the bus susceptance matrix defined by
\begin{equation}
\mathcal{B}_{km} = \begin{cases}
\sum_{km} x_{km}^{-1} & m=k\\
-x_{km}^{-1} & \text{for any line } km\\
0 & \text{otherwise}.
\end{cases}
\end{equation}
A direct calculations shows that 
\begin{equation}
\mathcal{B} = NYN^T
\end{equation}
where the diagonal entries of $Y$ represent the susceptance of each line and $N$ is the node-arc incidence matrix defined by
\begin{equation}
N_{i(k,m)} = \begin{cases}
1 & i=k\\
-1 & i=m\\
0 & \text{otherwise}.
\end{cases}
\end{equation}
Two conditions arise from Kirchoff's laws, namely the sum of power injections over all buses must be zero \ie $\sum_{k}P_k=0$ and that the line flows out of bus $k$ must equal the power injected at bus $k$ \ie $Np=P$ where $p=YN^T\theta$ is the active power flow. We wish to obtain a unique power flow solution $p$ for the given power injections $P$. However in the construction of $N$ it can be seen that the columns will sum to zero. This means that $N$ does not have full rank, in fact is has rank exactly $(n-1)$. Therefore without loss of generality remove the last column of $N$ to obtain $\tilde N$ which has full rank. In this setting $\tilde{\mathcal{B}}=\tilde N Y \tilde N^T$ is invertible and defines the equivalent system $\tilde N p = \tilde P$.Under the assumption that $\sum_{k}P_k=0$, the unique vector of feasible flows $p$ is given by
\begin{equation}
p = Y\tilde N^T(\tilde N Y \tilde N^T)^{-1}\tilde P.
\end{equation}

\section{Principle of Large Deviations}

\subsection{Chernoff Bound}
Consider $X_1,\dots,X_n$ \iid sequence of random variables with common p.d.f $P(X\le x)$. For $a>\mu$ and $\theta >0$, the Chernoff bound is given by
\begin{eqnarray*}
P\left(\frac{\sum_{i=1}^{n} X_i }{n}>a\right) &=& P\left(\sum_{i=1}^{n}  X_i > na \right)\\
&=& P\left(e^{\theta \sum_{i=1}^{n}  X_i} > e^{\theta na} \right)\\
&\le & \frac{E[e^{\theta \sum_{i=1}^{n}  X_i}]}{e^{\theta na}} \\
&=& \left(\frac{E[e^{\theta X}]}{e^{\theta a}} \right)^n\\
&=& e^{-n(\theta a - \log M_X(\theta))}\\
&=& e^{-n I(a)}
\end{eqnarray*}

where $I(a)$ is known as the {\it decay rate}. A Fenchel-Legendre transform of a r.v. X is the function 
\[\l(a) = \sup_\theta (\theta a - \log M_X(\theta)).\]
The Fenchel-Legendre transform coincides with the decay rate $I(a)$ since the supremum corresponds to the tightest bound. Under the limit as $n\to \infty$ the RHS goes to zero and therefore this upper bound becomes tight. 

\subsection{Simple Gaussian Case}
Consider $X_1,\dots,X_n$ \iid sequence of $N(\mu ,\sigma^2)$ random variables. The Fenchel-Legendre transform is given by
\[\l(a) = \sup_\theta (\theta a - (\theta\mu+\frac{\sigma^2}{2}\theta^2)).\]
Since this is quadratic in theta, it can easily be shown that the maximum, and hence decay rate is given by 
\[I(a) = \frac{(a-\mu)^2}{2\sigma^2}.\]
Therefore the Large Deviations Principle states that 
\[\lim_{n\to\infty} \frac{1}{n} \log P\left(\frac{\sum_{i=1}^{n} X_i }{n}>a\right) = -\frac{(a-\mu)^2}{2\sigma^2}.\]
This approach utilises the average of \iid random variables, where the average distribution $\bar X$ has mean $\mu$ and variance $\frac{\sigma^2}{n}$. Alternatively, let $\e=\frac{1}{n}$ and observe the limit as $\e\to 0$, \ie the random variable $Y\sim N(\mu, \e \sigma^2)$ follows the large deviation principle
\[\lim_{\e\to 0} \e \log P(Y>a) =-\frac{(a-\mu)^2}{2\sigma^2}\,.\]

\subsection{Line Power Flows}

The line power flows for each line $\l$ follow $(f_\e)_\l\sim N(\nu_\l, \e \sigma_\l^2)$ where $\sigma_\l^2 = \left(V\Sigma_p V^T\right)_{\l\l}$. The direction of flow across a line corresponds to the sign of $\mu_\l$. A line fails when the magnitude of flow $|(f_\e)_\l|\ge 1$. Therefore the absolute line power flows for each line $\l$ follow $|(f_\e)_\l |\sim N(|\nu_\l |, \e \sigma_\l^2)$. The large deviations principle for the absolute line power flows $|(f_\e)_\l|$ says that
\[\lim_{\e\to 0} \e \log P(|(f_\e)_\l|\ge 1) =-\frac{(1-|\nu_\l| )^2}{2\sigma_\l^2} = -I_\l \,,\]
where $I_\l$ is called the decay rate of $\l$. The decay rates $I_\l$ ultimately depend on the values of $\mu$ and $\Sigma_p$. Therefore we can relate the most likely power injections $\bm p^{(\l)}$ that caused the failure of line $\l$. Recall that $\bm p$ is multivariate Gaussian with probability density 
\[\varphi(\bm p) = \frac{\exp(-\frac{1}{2}(\bm p - \bm \mu)^T(\e\Sigma_p)^{-1}(\bm p-\bm \mu))}{(2\pi)^{\frac{n}{2}}\det(\e\Sigma_p)^{\frac{1}{2}}} \,.\]
We are interested in the conditional distribution of power injections $p$ given the failure event $|f_\ell| \ge1$. Under the limit as $\epsilon\to 0$ the tails of the distribution decay exponentially and therefore the probability $|f_\ell| \ge1$ can be approximated by $|f_\ell| =1$. The random variables $p\sim N_n(\mu,\epsilon\Sigma_p)$ and $|f_\ell|\sim N(|\nu_\ell|,\epsilon\sigma_\ell^2)$ are jointly normal, however the conditional distribution $p\mid |f_\ell| \ge1$ is degenerate since $|f_\ell| =1$ imposes a linear relation on the $p$'s. Alternatively, we construct the conditional $p_1,\dots,p_{n-1}\mid |f_\ell| \ge1$ with full rank covariance matrix which has a Gaussian distribution. An important property of the Gaussian distribution is that the mean corresponds to the value with largest probability. Hence maximising the conditional probability $P(\bm p\mid |f_\l|\ge 1)$ is equivalent to minimising the variational problem
\[\inf_{\bm p\ :\ \mid e_\l^TVp \mid \ge 1} \frac{1}{2}(\bm p - \bm \mu)^T\Sigma_p^{-1}(\bm p-\bm \mu) = -I_\l.\]
The infimum corresponding to the constraint $e_\ell^TVp\ge 1$ will be tight, so we can use Lagrange multipliers to solve the constrained quadratic program. The Lagrange equation is given by
\[L( p,\lambda) = \frac{1}{2}( p -  \mu)^T\Sigma_p^{-1}( p- \mu) -\lambda(e_\ell^TVp -1)\,,\]
and we solve with respect to $\frac{\partial L}{\partial \lambda} = \frac{\partial L}{\partial p} = 0$. Trivially, $\frac{\partial L}{\partial \lambda}=0$ implies $e_\ell^TVp =1$. 
\[\begin{aligned}\frac{\partial L}{\partial p} = ( p -  \mu)^T\Sigma_p^{-1}-\lambda e_\ell^TV =& 0\\
( p -  \mu)^T =& \lambda e_\ell^TV \Sigma_p\\
p =& \mu + \lambda\Sigma_pV^Te_\ell\\
\text{Also }\quad e_\ell V(p-\mu) =& \lambda e_\ell^T V \Sigma_pV^Te_\ell\\
\implies \lambda =& \frac{1-\nu_\ell}{\sigma_{\ell}^2}
\end{aligned}\]
This can be done similarly for the constraint $e_\ell^TVp =-1$, to get the two optimisers
\begin{eqnarray*}
p^{(\ell,+)} &=& \mu + \frac{1-\nu_\ell}{\sigma_{\ell}^2}\Sigma_pV^Te_\ell \\
p^{(\ell,-)} &=& \mu + \frac{-1-\nu_\ell}{\sigma_{\ell}^2}\Sigma_pV^Te_\ell\,.
\end{eqnarray*} 
The infimum will correspond to the minimum of $\{\,p^{(\ell,+)}, p^{(\ell,-)\,}\}$, which is dictated by $\text{sign}(\nu_\ell)$. By simple substitution the line power flows corresponding to power injections $p^{(\ell)}$ are given by 
\[f^{(\ell)} = \nu+\frac{\text{sign}(\nu_\ell)-\nu_\ell}{\sigma_{\ell}^2}V\Sigma_pV^Te_\ell\,.\]


\section{Bienstock 2016}

\subsection{Cascade model}

The general construction of the cascade model is given by
\begin{enumerate}
\item A set of lines become randomly outaged.
\item Reset loads, generation and power flows to adjust to line outage.
\item Test for new line outages.
\item If no new lines outage the cascade stops.
\end{enumerate}

Cascade model 1, aims to capture the idea of upgrading equipment after failure. In the case of lines, this would be increasing their rating (capacity). This models this long term cascade behaviour, but the short term cascade model is based on non-decreasing probability function. In the first instance that a line becomes overloaded
\begin{equation}
P(\text{line } j \ \text{becomes outaged}) = h^0(|f_{j,t}|/U_{j,t}^{\text{max}})=c
\end{equation}
for all lines $j$. Then after redistribution overloaded lines outage with probability $h^1>c$. Another quantity pointed out is average relative line load on a given day $t$,
\begin{equation}
\bar{M}_t \dot{=}\frac{\sum_j M_{jt}}{m}
\end{equation}
where $m$ indicates the number of lines. It was found that for a given $\mu$ the systems seems to tend toward a long term ``dynamic equilibrium". This suggests that for a constant rate of demand growth line upgrades is not sufficient to avert blackouts.\\

\subsection{Economic dispatch}

The economic dispatch problem is concerned with minimising the total cost of generation such that the demand is satisfied.  

After a line $(i,j)$ outages, the power flow $f_{ij}$ along that line becomes zero. Instead of removing the line from the formulation, we scale the reactance $x_{ij}$ up by a large constant and the limit $u_ij$ down by a small number $\e>0$. This approximates the flow $f_{ij}$ to be nearly zero. This approach ensures the network remains connected (an essential feature to perform economic dispatch). 

A linear program is solved to obtain the new power flows, loads and generation. Each bus is either a generator $g\in \mc G$ or a load $j\in \mc L$ and define $P_g$ and $D_j$ to represent its generation output or demand, respectively. The corresponding constraints are then
\[P_g \le P_g^{\t{max}} \ \forall g\in \mc G, \quad D_j \ge 0 \ \forall j\in \mc L\,,\]
 where $P_g^{\t{max}}$ is the maximum generation output of $g\in \mc G$. As a shorthand, define 
 \[p_i = \begin{cases}P_i & i\in \mc G\\ D_i & i\in \mc L\\ 0 & \t{otherwise} \end{cases}.\]
 The following constraints arise from the DC model. Generation and loads must be balanced, \ie $\sum_i p_i =0$. The conservation of power flow requires $Nf-p=0$, where $N$ is the node arc incidence matrix. Ohm's law, $x_{ij}f_{ij} = \theta_i-\theta_j$ must be satisfied. 

\subsection{Thermal line tripping}

A lines temperature is a function of current, such that higher currents lead to higher temperatures. Grid operators try to avoid high line temperatures as this leads sagging and deformation of the line. Such behaviour is known to cause a line to trip as sagging can result in the line coming into contact with an external object like a tree. 

\subsection{Accumulated overload}

\subsection{Moving average flow}

\subsection{Loading-dependent system}

Consider a system where each line $j$ has an initial load $L_j$ chosen uniformly from $[L^{min}, L^{max}]$. Additionally there exists a threshold $L^{fail}$ such that if at any stage during the cascade $L_j\ge L^{fail}$ the line $j$ is outaged. The cascade is initiated by some initial disturbance which adds the load $D$ onto every line. The initial disturbance is chosen such that there is at least one initial outage that satisfies
\[ L_j + D \ge L^{fail},\]
that will start the cascade event. Power that is redistributed, due to each line failure event, places more stress on the (unfailed) lines. This effect is approximated such that each line failure results in an increase of $P$ to every (unfailed) line. Define $M_i$ to be the number of line failures in stage $i$ and then the number of component failures prior to stage $t$ is given by
\[S_{t-1} = \sum_{i=0}^{t-1} M_i.\]
Using this notation the lines that fail at stage $t$ (given they haven't failed in a previous stage) of the cascade satisfy
\[ L_j+D+S_{t-1}P \ge L^{fail}.\]
However it has proved constructive to investigate the system of normalised load flows. Under normalisation the initial load of each line $j$ is 
\[\ell_j = \frac{L_j-L^{min}}{L^{max}-L^{min}},\]
such that $\l_j \in [0,1]$. Also define the normalised power increment and normalised initial disturbance to be
\[p = \frac{P}{L^{max}-L^{min}} \ \text{and} \  d = \frac{D+L^{max}-L^{fail}}{L^{max}-L^{min}},\]
where the quantity $L^{max}-L^{fail}$ present in the numerator of $d$ translates the initial disturbance based on the relationship between $L^{max}$ and $L^{fail}$. Note that in this setting if at any stage $\l_j \ge 1$ line $j$ fails. Now that the cascade model has been constructed we wish to observe the distribution of the size $S$ of a cascade event. It is convenient to relate the distribution of number of failures with the normalised parameters by writing
\[P(S=r) = f(r,d,p,n).\]
 First consider the distribution of $M_0$. In the initial stage the independent probability of failure is $d$ for each line. Therefore the probability that $k$ lines initially fail is given by
\[P(M_0=k) = {n\choose k} d^k(1-d)^k.\]
Therefore given $k$ initial failures, in the second stage we have $\l_j\in [0,1-d]$ and from the formulas, $d = \frac{kp}{1-d}$ and $p = \frac{p}{1-d}$. Conditioning on the intial number of failures and using the law of total probability we arrive at the recursive relation 
\begin{eqnarray*}
f(r,d,p,n) &=& P(S=r)\\
&=& \sum_{k=1}^{r} P(S=r|M_0 = k)P(M_0=k)\\
&=&\sum_{k=1}^{r} {n\choose k} d^k(1-d)^k f(r-k,\frac{kp}{1-d},\frac{p}{1-d}, n-k).
\end{eqnarray*}
Notice the sum omits $k=0$ as if there are no initial events then there is no cascade and is therefore just zero. Performing induction on $r$ demonstrates that the number of component failures has a quasi-binomial distribution.The base case $r=0$ 
\[f(0,d,p,n) = (1-d)^n \ \forall d,n,p \text{ s.t. } d+np<1,\] 
satisfies the form of the quasi-binomial. Assume that the condition holds for all cascade sizes $m<r$ such that
\[ f(m,d,p,n) = {n\choose m} d(d+mp)^{m-1} (1-d-mp)^{n-m} \ \forall d,n,p \text{ s.t. } d+np<1.\]
The substitution into the recursive formula can be made
\begin{eqnarray*}
f(r,d,p,n)&=&\sum_{k=1}^{r} {n\choose k} d^k(1-d)^k {n-k \choose r-k} \frac{kp}{1-d} \left(\frac{rp}{1-d}\right)^{r-k-1} \left(1-\frac{rp}{1-d}\right)^{n-r}\\
&=&{n \choose r} \left(1-d-rp\right)^{n-r} \sum_{k=1}^{r} {r\choose k} \frac{k}{r} d^k \left(rp\right)^{r-k}\\
&=& {n \choose r} d (d+rp)^{r-k-1} \left(1-d-rp\right)^{n-r}.
\end{eqnarray*}
This verifies that the distribution of the number of component failures is quasi-binomial. Note that this is under the assumption that $D$ and $P$ are small enough such that the cascade stops before all lines fail. Under this same constraint, assume there exists constants $\theta$ and $\lambda$ such that as $n\to \infty$ the relations $nd = \theta$ and $np = \lambda$ hold. This distribution can be approximated in the following way,
\begin{eqnarray*}
\lim_{n\to \infty} P(S=r) &=& \lim_{n\to \infty} \frac{n!}{r!(n-r)!} d (d+rp)^{r-k-1} \left(1-d-rp\right)^{n-r}\\
&=& \lim_{n\to \infty} \frac{n!}{r!(n-r)!} \frac{1}{n^r} \theta(\theta + r\lambda)^{r-1} \left(1-\frac{d-rp}{n}\right)^{n-r}\\
&=& \theta(\theta + r\lambda)^{r-1} \lim_{n\to \infty} \frac{n!}{r!(n-r)!} \frac{1}{n^r} \lim_{n\to \infty} \left(1-\frac{d-rp}{n}\right)^{n} \lim_{n\to \infty} \left(1-\frac{d-rp}{n}\right)^{-r}\\
&\approx& \theta(\theta + r\lambda)^{r-1} \frac{e^{-(\theta+r\lambda)}}{r!}, \quad 0\le r\le n-1,
\end{eqnarray*}
to be a generalised Poisson distribution. This expression is the distribution of the number of individuals produced in a branching process, where initial generation of individuals is Poisson with parameter $\theta$ and the following generations are Poisson with parameter $\lambda$. This provides a suitable method to obtain estimates of the parameters $\theta$ and $\lambda$ from forced outage data.

\subsection{Branching Process}

We can construct a branching process where each line outage $i$ in the $j$th stage produces a random number $\zeta_{i,j}$ of line outages in the $(j+1)$th stage of cascade. The $\zeta_{i,j}$ are i.i.d. Poisson random variables with rate $\lambda$ i.e. each line outage is expected to give rise to $\lambda$ more line outages. Define $M_j$ to be the number of line outages in stage $j$ and let the initial stage consist of $M_0=1$, then for $j\ge 0$ we have that
\[M_{j+1} = \sum_{i=1}^{M_j} \zeta_{i,j}\]
which is a (Galton-Watson) Poisson branching process. We are interested in finding the distribution of the total number of line outages $S$ where 
\[S = \sum_{j=1}^{N} M_j.\]
Denote the p.g.f. of $\zeta_{i,j}$ as $g(z)$ given by
\[g(z) = e^{\lambda(z-1)}.\]
Define $S_m$ to be the number of failures in the first $m$ stages of cascade and denote $G_m(z)$ to be the p.g.f. We can observe that
\[S_1 = M_0+M_1 = 1+\zeta_{1,1},\]
has p.g.f given by
\[G_1(z) = zg(z),\]	
from the independence of $1$ and $\zeta_{i,j}$. Therefore we have independent Poisson branching processes of length $n-1$ that are generated by $G_1(z)$, which we can write as
\[S_n = 1+ \sum_{i=1}^{M_1} A_{n-1}^{(i)},\]
where $A_{n-1}^{(i)}$ represents the number of outages in $n-1$ stages produced by each outage $i$ in the first stage.
\[\begin{aligned} G_n(z) =& E\left[z^{S_n}\right]\\
=& E\left[ E\left[ z^{1+ \sum_{i=1}^{M_1} A_{n-1}^{(i)}}\mid M_1 \right] \right] \\
=& E\left[ zG_{n-1}(z)^{M_1}\right] \\
=& zg(G_{n-1}(z))
\end{aligned}\]
Under the "no saturation" principle we have that $G(z) = \lim_{j\to \infty} G_j(z)$ exists and is given by
\[G(z) = zg(G(z)) = ze^{\lambda(G(z)-1)}.\]
This is known to be the p.g.f of the Borel distribution with pmf given by
\[P(S=r) = \frac{(r\lambda)^{r-1}}{r!}e^{-r\lambda}.\] \\

The Galton-Watson approach differs to the generalised Poisson branching process through the initial condition $M_0=1$. What we really want is this initial condition $M_0$ to be Poisson with rate $\theta$. This is equivalent to thinking about the distribution of the sum of $N$ random variables with Borel distribution such that $N$ is Poisson with parameter $\theta$. \\

Let $(X_n)$ be a sequence of i.i.d. random variables with Borel distribution with parameter $\lambda$ and let $N$ be a Poisson random variable with parameter $\theta$. Then we want to show that the total number of failed components $S=\sum_{k=1}^{N}X_k$ has a generalised Poisson distribution with pmf
\[P(S=r) = \theta(\theta + r\lambda)^{r-1} \frac{e^{-(\theta+r\lambda)}}{r!}.\]
First we will consider a fixed sum of Borel distributions. Let $X^{(m)}= X_1+\dots+X_m$ where $X_i$ are IID random variables with Borel distribution. We will use the property that 
\[\sum_{\substack{(n_1,\dots,n_k)\in \mathbb{N}^k\\ n_1+\dots+n_k=n}} \frac{n!}{n_1!\cdots n_k! k!} \prod_{\l=1}^{k} \left(\frac{n_\l}{n}\right)^{n_\l-1} = {n-1\choose k-1}.\]
to show that $X^{(m)}$ is a Borel-Tanner distribution.
\[\begin{aligned}
P(X^{(m)}=n) =&  P \left( \sum_{k=1}^{m} X_k=n \right)\\
=& \sum_{\substack{(n_1,\dots,n_m)\in \mathbb{N}^m\\ n_1+\dots+n_m=n}} \prod_{\l=1}^{m} P(X=n_\l) \qquad (X \text{ is Borel})\\
=& \sum_{\substack{(n_1,\dots,n_m)\in \mathbb{N}^m\\ n_1+\dots+n_m=n}} \prod_{\l=1}^{m} \frac{(n_\l\lambda)^{n_\l-1}}{n_\l!}e^{-\lambda n_\l} \\
=& \sum_{\substack{(n_1,\dots,n_m)\in \mathbb{N}^m\\ n_1+\dots+n_m=n}} \lambda^{n_1-1}\cdots\lambda^{n_m-1}e^{-\lambda n_1}\cdots e^{-\lambda n_m} \prod_{\l=1}^{m} \frac{n_\l^{n_{\l-1}}}{n_\l!}\\
=& \sum_{\substack{(n_1,\dots,n_m)\in \mathbb{N}^m\\ n_1+\dots+n_m=n}} \lambda^{n-m} e^{-\lambda n} \frac{1}{n_1!\cdots n_m!} \prod_{\l=1}^{m} n_\l^{n_{\l-1}}\\
=& \frac{m! (\lambda n)^{n-m}}{n!}e^{-\lambda n} \sum_{\substack{(n_1,\dots,n_m)\in \mathbb{N}^m\\ n_1+\dots+n_m=n}} \frac{n!}{n_1!\cdots n_m!m!}  \prod_{\l=1}^{m} \left(\frac{n_\l}{n}\right)^{n_{\l-1}}\\
=&{n-1\choose k-1} \frac{m! (\lambda n)^{n-m}}{n!} e^{-\lambda n}\\
=& \frac{m(\lambda n)^{n-m}}{n(n-m)!}e^{-\lambda n}
\end{aligned} \]

This provides understanding of the distribution of a fixed sum of Borel distributions. We now turn our attention to the random sum of $N$ Borel distributions.

\[\begin{aligned}
P(S=r) =& P\left( \sum_{k=1}^{N}  X_k=r \right)\\
=& \sum_{m=1}^{\infty} P\left(\sum_{k=1}^{m} X_k=r|N=m \right)P(N=m)\\
=& \sum_{m=1}^{r} \frac{\theta^m}{m!}e^{-\theta} P(X^{(m)} = r|N=m)\\
=& \sum_{m=1}^{r} \frac{\theta^m}{m!}e^{-\theta} \frac{m(r\lambda)^{r-m}}{r(r-m)!}e^{-r\lambda} \quad \text{(Borel Tanner dist.)}\\
=& \frac{\theta}{r!} \sum_{m=1}^{r} \frac{(r-1)!}{(m-1)!(r-m)!} \theta^{m-1}(r\lambda)^{r-m}e^{-(\theta+r\lambda)}\\
=& \frac{\theta}{r!}e^{-(\theta+r\lambda)} \sum_{m=0}^{r-1} {r-1\choose m} \theta^m (r\lambda)^{r-1-m}\\
=& \theta(\theta + r\lambda)^{r-1} \frac{e^{-(\theta+r\lambda)}}{r!} \quad \text{(Binomial theorem)}
\end{aligned}\]

Finner, H., Kern, P. and Scheer, M., 2015. On some compound distributions with Borel summands. Insurance: Mathematics and Economics, 62, pp.234-244.

\subsection{Line outage distribution factors}
Consider power flow across the line $k=(a,b)$ given the failure of line $\ell=(i,j)$ and denote by $f_k^{(\ell)}$. Such an event is known as an isolated failure and the flow redistribution can be calculated using line outage distribution factors (LODF). The power that flowed across line $\ell$ redistributes throughout the altered network $\tilde G^{(\ell)}$. This redistribution is governed by power flow physics. Namely, we are interested in finding the coefficient vector $\phi_k^{(\ell)}$ that represents the change in power flow across line $k$ given the failure of line $\ell$. The original power flows can be used to find the new power flows across the altered network 
\[\tilde f_k^{(\ell)} = f_k + \phi_k^{(\ell)}f_\ell^{(\ell)}\,,\]
for every $k\ne \ell$ and where $f_\ell^{(\ell)} = \pm 1$ depending on how $\ell$ fails. 

Recall, under the DC power model we have that 
\[\theta = L^+P\quad \text{and} \quad f = WBC\theta\,\]
where $L^+$ is the pseudo-inverse of the weighted Laplacian matrix. The construction of the Laplacian matrix is $L=C^TBC$ where $C$ is the edge-vertex incidence matrix. In summation notation this is $L = \sum_{i=1}^{m} \beta_i\gamma_i^T\gamma_i$ where $\gamma_i$ is the row vector of the $i$th row of $C$. The altered Laplacian caused by the outage of line $\ell$ is given by
\[\tilde L = L - \beta_{\ell}\gamma_{\ell}^T\gamma_{\ell}\,,\]
i.e, the original Laplacian minus the contribution of line $\ell$.  The psuedo-inverse is calculated using Meyer's relation and is given by
\[\tilde L^+ = L^+ + \frac{L^+\gamma_{\ell}^T\beta_{\ell}\gamma_{\ell}L^+}{1-\beta_{\ell}\gamma_{\ell}L^+\gamma_{\ell}^T}\,.\]
The change in phase angles caused by the failure of line $\ell$ is given by
\[\Delta \theta^{(\ell)} = (\tilde L^+ - L^+)P\,.\]
Substituting in for the altered Laplacian $\tilde L^+$ we have that 
\[\Delta \theta^{(\ell)} = \left(\frac{L^+\gamma_{\ell}^T\beta_{\ell}\gamma_{\ell}L^+}{1-\beta_{\ell}\gamma_{\ell}L^+\gamma_{\ell}^T}\right)P \,. \]
The power flow across line $\ell$ before failure is given by
\[f_{\ell}^{(\ell)} = \frac{1}{C_\ell}\beta_{\ell}\gamma_{\ell}L^+P\,.\]
The change in power flow of line $k$ is given by 
\[\Delta f_k^{(\ell)} = W_k \beta_k \gamma_k^T \Delta \theta^{(\ell)} = \beta_k \frac{C_\ell}{C_k} \frac{\gamma_kL^+\gamma_{\ell}^T}{1-\beta_{\ell}\gamma_{\ell}L^+\gamma_{\ell}^T} f_{\ell}^{(\ell)}\,,\]
and therefore the LODF coefficients are given by
\[\phi_k^{\ell} = \beta_k \frac{C_\ell}{C_k} \frac{\gamma_kL^+\gamma_{\ell}^T}{1-\beta_{\ell}\gamma_{\ell}L^+\gamma_\ell^T}\,.\]

Recall that under the DC model $\theta = L^+P$. For one unit current injected at $i$ and leaves at $j$, our power injections vector $P = e_i-e_j$. The result for effective resistance under the DC model is
\[\begin{aligned} R_{ij} =& \theta_i-\theta_j\\
=& (e_i-e_j)^T\theta\\
=& (e_i-e_j)^TL^+(e_i-e_j)\\
=& (L^+)_{ii} + (L^+)_{jj} -2(L^+)_{ij}\,.
\end{aligned}\]
If there exists a line $\ell = (i,j)$ in the network then $e_i-e_j$ corresponds to $\gamma_\ell$ which is the row vector of the $\ell$th row of the edge-vertex incidence matrix $C$, i.e., 
\[R_{ij} =\gamma_\ell L^+\gamma_\ell^T\,.\] 

Now the numerator can also be defined in terms of effective resistance. First observe that all the diagonal elements, say $(L^+)_{kk}$, cancel in the quantity $\frac{1}{2}(R_{aj}-R_{ai}+R_{bi}-R_{bj})$.  
\[\begin{aligned}
\frac{1}{2}(R_{aj}-R_{ai}+R_{bi}-R_{bj}) =& (L^+)_{ai}-(L^+)_{aj}+(L^+)_{bj}-(L^+)_{bi}\\
=& (e_a-e_b)^TL^+(e_i-e_j)\\
=& \gamma_kL^+\gamma_\ell^T\,.
\end{aligned}\]

Therefore the LODF is defined as
\[\phi_k^{\ell} = \beta_k \frac{C_\ell}{C_k} \frac{R_{aj}-R_{ai}+R_{bi}-R_{bj}}{2(1-\beta_\ell R_{ij})}\,.\]



\section{Effective resistance}
Effective resistance is a term used to define the resistance between two nodes in an electric network. In the graph theory this is commonly known as resistance distance between two vertices of a weighted, simple, connected graph. The effective resistance is established by connecting a voltage source across two vertices $a$ and $b$. Let $I_{ab}$ be the net current that flows from $a$ to $b$. Then from Ohm's law we define the effective resistance between vertices $a$ and $b$ to be
\[R_{ab} = \frac{v_a-v_b}{I_{ab}}.\] 
Fix the current flow between $a$ and $b$ to be $I_{ab}=1$, then the effective resistance reduces to 
\[R_{ab} =v_a-v_b\]

\section{Empirical Time Series Analysis}
A univariate time series consists of observations, $y_t$, that are made repeatedly over time. The standard time series model is to write 
\[Y(t) = \mu(t) + U(t)\]
where $\mu(t)$ is the deterministic signal and $U(t)$ is the noise process assumed to be stationary with $E[U(t)]=0$. 

Differencing a time series is a method traditionally use to eliminate the trend represented by the signal $\mu(t)$. The first order differencing operator $D$ is defined by
\[Dy_t = y_t-y_{t-1}\,. \]
Higher order differences are successive applications of the differencing operator. 

Consider a second order stationary process $Y(t)$. The auto-covariance function is defined by 
\[\gamma(s) = \t{cov}(Y(t), Y(t+s))\]




\section{Network Diagram}

Record of the changes to the network based on connecting and disconnecting relevant lines.
\begin{enumerate}
\item King Creek and Blue Valley are not present in Network diagram pdf.
\item Murarrie was misspelled as Murarie.
\item Murray Bridge Pump 2 to Murray Bridge Pump 3 | Murray Bridge-Hahndorf Pump 2 to Murray Bridge-Hahndorf Pump 3.
\item Rocklea-H16 to Tennyson-T142 | Rocklea-H16 to Tennyson.
\item Larcom Creek to Yarwun-H058 | Larcom Creek to Yarwun.
\item Queensland Alumina Limited South to Tee | Queensland Alumina Limited South Tee to Tee
\item Jindabyne Power Station to Jindabyne Substation | Jindabyne Power Station to Jindabyne
\item Snuggery Power Station to Snuggery Substation | Snuggery Power Station to Snuggery 
\item Wattle Point Wind Farm to Wattle Point Substation | Wattle Point Wind Farm to Wattle Point Wind Farm Substation
\item Playford B Power Station to Playford B Substation | Playford B Power Station to Playford B
\item Hallet 5 Wind Farm to Belalie Substation | Hallet 5 Wind Farm to Belalie
\item Mortlake Power Station to Mortlake Power Station substation | Mortlake Power Station to Mortlake
\item Clover Hydro Power Station to Clover Substation | Clover Power Station to Clover Substation
\item Symex Port Melbourne Power Station to Fishermans Bend | Symex Port Melbourne Power Station to Fishermans Bend Terminal
\item Warragamba Power Station to Warragamba Substation | Warragamba Power Station to Warragamba
\item Meadowbank T Power Station to Meadowbank | Meadowbank T Power Station to Meadowbank T
\item Hallett Power Station to Canowie | Hallet Power Station to Canowie
\item Studland Wind Farm to Studland | Studland Wind Farm to Studland Bay
\item West Castle Hiill | West Castle Hill
\item Ballarat North to Ballarat | Ballarat North to Ballarat Terminal
\item Mussleroe Wind Farm to Derby Tee | Mussleroe Wind Farm to Derby
\item Ashgrove West to Kelvin Grove | Ashgrove West-T30 to Kelvin Grove
\end{enumerate} 



\bibliographystyle{acm}
\bibliography{../mphil_lib.bib}

\end{document}